<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta
      http-equiv="Content-Security-Policy"
      content="default-src 'self'; script-src 'self'; style-src 'self' 'unsafe-inline'"
    />
    <title>Job Applicator</title>
    <link rel="stylesheet" href="styles.css" />
  </head>
  <body>
    <div class="toolbar">
      <button class="btn-nav" id="backBtn" title="Back" aria-label="Go back">‚Üê</button>
      <input type="text" class="url-input" id="urlInput" placeholder="Enter job application URL..." />
      <button class="btn-go" id="goBtn">Go</button>
      <button class="btn-submit" id="submitJobBtn">Submit Job</button>
      <span class="status" id="status">Ready</span>
    </div>

    <div class="sidebar" id="sidebar">
      <div class="sidebar-content">
        <!-- Auth Section -->
        <section class="sidebar-section auth-section" id="authSection">
          <div class="auth-status" id="authStatus">
            <div class="auth-user hidden" id="authUser">
              <span class="user-email" id="userEmail"></span>
              <button class="btn-logout" id="logoutBtn" title="Sign out">Sign Out</button>
            </div>
            <div class="auth-login" id="authLogin">
              <span class="auth-message">Sign in to access your job matches</span>
              <button class="btn-login" id="loginBtn" aria-label="Sign in with Google">Sign In with Google</button>
            </div>
          </div>
        </section>

        <!-- Workflow Progress Section -->
        <section class="sidebar-section workflow-section">
          <div class="workflow-progress" id="workflowProgress" role="group" aria-label="Application workflow progress">
            <div class="workflow-step" data-step="job">
              <span class="step-indicator" aria-hidden="true"></span>
              <span class="step-label">Job</span>
              <span class="sr-only" id="job-status">pending</span>
            </div>
            <div class="workflow-connector" aria-hidden="true"></div>
            <div class="workflow-step" data-step="docs">
              <span class="step-indicator" aria-hidden="true"></span>
              <span class="step-label">Docs</span>
              <span class="sr-only" id="docs-status">pending</span>
            </div>
            <div class="workflow-connector" aria-hidden="true"></div>
            <div class="workflow-step" data-step="fill">
              <span class="step-indicator" aria-hidden="true"></span>
              <span class="step-label">Fill</span>
              <span class="sr-only" id="fill-status">pending</span>
            </div>
            <div class="workflow-connector" aria-hidden="true"></div>
            <div class="workflow-step" data-step="submit">
              <span class="step-indicator" aria-hidden="true"></span>
              <span class="step-label">Submit</span>
              <span class="sr-only" id="submit-status">pending</span>
            </div>
          </div>
        </section>

        <!-- Job Matches Section -->
        <section class="sidebar-section">
          <div class="section-header">
            <h3 class="section-title">Job Match</h3>
            <button class="btn-refresh" id="refreshJobsBtn" title="Refresh job matches (Ctrl+R)" aria-label="Refresh job matches (Ctrl+R)">
              <span class="refresh-icon">‚Üª</span>
            </button>
          </div>
          <select id="jobSelect" class="job-select" disabled>
            <option value="">-- Select Job --</option>
          </select>
        </section>

        <!-- Job Actions Section (shown when job selected) -->
        <section class="sidebar-section job-actions-section hidden" id="jobActionsSection">
          <h3 class="section-title">Actions</h3>
          <div class="job-actions">
            <button class="btn-mark-applied" id="markAppliedBtn">Mark as Applied</button>
            <button class="btn-mark-ignored" id="markIgnoredBtn">Ignore</button>
          </div>
        </section>

        <!-- Documents Section -->
        <section class="sidebar-section" id="documentsSection">
          <h3 class="section-title">Documents</h3>
          <div class="document-selectors">
            <div class="document-selector">
              <label for="resumeSelect">Resume</label>
              <div class="document-select-row">
                <select id="resumeSelect" class="document-select" disabled>
                  <option value="">-- Select Resume --</option>
                </select>
                <button class="btn-preview" id="previewResumeBtn" disabled title="Preview selected resume">üëÅ</button>
              </div>
            </div>
            <div class="document-selector">
              <label for="coverLetterSelect">Cover Letter</label>
              <div class="document-select-row">
                <select id="coverLetterSelect" class="document-select" disabled>
                  <option value="">-- Select Cover Letter --</option>
                </select>
                <button class="btn-preview" id="previewCoverLetterBtn" disabled title="Preview selected cover letter">üëÅ</button>
              </div>
            </div>
          </div>
          <div class="section-actions generate-actions">
            <select id="generateType" class="generate-type-select">
              <option value="both">Resume + Cover Letter</option>
              <option value="resume">Resume Only</option>
              <option value="coverLetter">Cover Letter Only</option>
            </select>
            <button class="btn-generate" id="generateBtn" disabled>Generate</button>
          </div>
          <!-- Generation Progress -->
          <div class="generation-progress hidden" id="generationProgress">
            <div class="generation-steps" id="generationSteps"></div>
          </div>
          <!-- Document Review Form -->
          <div class="document-review hidden" id="documentReview">
            <div class="review-header">
              <h4 class="review-title" id="reviewTitle">Review Resume</h4>
              <p class="review-subtitle">Edit the AI-generated content below before finalizing.</p>
            </div>
            <div class="review-content" id="reviewContent">
              <!-- Content populated dynamically -->
            </div>
            <div class="review-actions">
              <button class="btn-approve" id="approveReviewBtn">Approve & Continue</button>
              <button class="btn-cancel-review" id="cancelReviewBtn">Cancel</button>
            </div>
          </div>
          <!-- Upload Actions (enabled when file input detected and document selected) -->
          <div class="upload-actions" id="uploadActions">
            <div class="upload-status" id="uploadStatus">
              <span class="upload-status-icon">‚ö†</span>
              <span class="upload-status-text" id="uploadStatusText">No file input detected</span>
              <button class="btn-rescan" id="rescanBtn" title="Re-scan page for file inputs">Rescan</button>
            </div>
            <div class="upload-buttons">
              <button class="btn-upload-resume" id="uploadResumeBtn" disabled title="Select a document and navigate to a page with file upload">
                Upload Resume
              </button>
              <button class="btn-upload-cover" id="uploadCoverBtn" disabled title="Select a document and navigate to a page with file upload">
                Upload Cover Letter
              </button>
            </div>
          </div>
        </section>

        <!-- Agent Session Section -->
        <section class="sidebar-section" id="agentSection">
          <div class="section-header">
            <h3 class="section-title">Agent Session</h3>
            <div class="agent-status" id="agentStatus">
              <span class="status-dot stopped"></span>
              <span class="status-text">Stopped</span>
            </div>
          </div>

          <div class="agent-controls">
            <select id="agentProviderSelect" class="provider-select">
              <option value="claude">Claude</option>
              <option value="codex">Codex</option>
              <option value="gemini">Gemini</option>
            </select>
            <button class="btn-start-session" id="startSessionBtn">Start Session</button>
            <button class="btn-stop-session hidden" id="stopSessionBtn">Stop</button>
          </div>

          <div class="agent-actions hidden" id="agentActions">
            <button class="btn-fill" id="fillFormBtn">Fill Form</button>
          </div>

          <div class="agent-output" id="agentOutput">
            <div class="empty-placeholder">Start session to begin</div>
          </div>
        </section>
      </div>
    </div>

    <script src="app.js"></script>
  </body>
</html>
